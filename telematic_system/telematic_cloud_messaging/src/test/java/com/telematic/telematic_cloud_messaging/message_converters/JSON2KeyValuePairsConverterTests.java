package com.telematic.telematic_cloud_messaging.message_converters;

import static org.junit.jupiter.api.Assertions.assertEquals;

<<<<<<< HEAD
import java.util.ArrayList;
=======
>>>>>>> origin/master
import java.util.Arrays;
import java.util.List;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.TestPropertySource;

@SpringBootTest
@ActiveProfiles("test")

@TestPropertySource(properties = {
    "logging.level.root=INFO",
    "MESSAGING_LOGGING_LEVEL=INFO",
    "MESSAGING_NATS_URI=nats://localhost:4222",
    "MESSAGING_NATS_MAX_RECONNECTS=5",
    "MESSAGING_INFLUX_BUCKET_TYPE=ALL",
    "MESSAGING_INFLUX_URI=localhost",
    "MESSAGING_INFLUX_PORT=8086",
    "MESSAGING_INFLUX_USERNAME=admin",
    "MESSAGING_INFLUX_PWD=P@ssword1",
    "MESSAGING_INFLUX_BUCKET_STREETS=infrastructure-dev",
    "MESSAGING_STREETS_SUBSCRIPTION_TOPIC=streets.*.data.",
    "MESSAGING_INFLUX_BUCKET_PLATFORM=platform-dev",
    "MESSAGING_PLATFORM_SUBSCRIPTION_TOPIC=platform.*.data.",
    "MESSAGING_INFLUX_BUCKET_CLOUD=infrastructure-dev",
    "MESSAGING_CLOUD_SUBSCRIPTION_TOPIC=cloud.*.data.",
    "MESSAGING_NUMBER_TOPICS_PER_DISPATCHER=3",
    "MESSAGING_VEHICLE_UNIT_ID_LIST=vehicle_id",
    "MESSAGING_STREETS_UNIT_ID_LIST=streets_id,rsu_id",
    "MESSAGING_CLOUD_UNIT_ID_LIST=cloud_id",
    "MESSAGING_INFLUX_ORG=my-org",
    "MESSAGING_INFLUX_TOKEN=my-super-secret-auth-token",
    "MESSAGING_TO_STR_FIELDS=hostBSMId,TrafficControlRequest.reqid,tcmV01.reqid,m_header.sender_bsm_id,core_data.id",
    "MESSAGING_IGNORE_FIELDS=payload.MessageFrame.value.PersonalSafetyMessage.id",
    "MESSAGING_INFLUX_CONNECT_TIMEOUT=1000",
    "MESSAGING_INFLUX_WRITE_TIMEOUT=1000",
    "MESSAGING_DB_DRIVER=com.mysql.cj.jdbc.Driver",
    "MESSAGING_DB_URL=jdbc:mysql://localhost:3307/wfd_grafana",
    "MESSAGING_DB_USERNAME=telematic",
    "MESSAGING_DB_PASSWORD=telematic",
    "MESSAGING_DB_DIALECT=org.hibernate.dialect.MySQLDialect"
})
public class JSON2KeyValuePairsConverterTests {
    @Autowired
    JSON2KeyValuePairsConverter converter;

    @Test
    public void convertJson2KeyValuePairs() {
<<<<<<< HEAD
        List<String> to_str_fields = Arrays.asList("hostBSMId,TrafficControlRequest.reqid,tcmV01.reqid".split(","));
        String json_str = "{\"metadata.unit_name\":\"BlackPacifica\",\"metadata.event_name\":\"UC3\",\"metadata.location\":\"TFHRC\",\"metadata.unit_type\":\"Platform\",\"metadata.unit_id\":\"DOT-508\",\"metadata.testing_type\":\"Integration\",\"payload.core_data.sec_mark\":\"40328\",\"payload.core_data.heading\":\"6160\",\"payload.core_data.brakes.scs\":\"0\",\"payload.core_data.brakes.abs\":\"0\",\"payload.core_data.brakes.aux_brakes\":\"0\",\"payload.core_data.brakes.brake_boost\":\"0\",\"payload.core_data.brakes.traction\":\"0\",\"payload.core_data.accel_set.vert\":\"-127\",\"payload.core_data.accel_set.lat\":\"2\",\"payload.core_data.accel_set.long\":\"-79\",\"payload.core_data.accel_set.yaw\":\"12\",\"payload.core_data.accuracy.orientation\":\"65535\",\"payload.core_data.accuracy.semi_minor\":\"255\",\"payload.core_data.accuracy.semi_major\":\"255\",\"payload.core_data.long\":\"-77.1476267\",\"payload.core_data.speed\":\"282\",\"payload.core_data.transmission\":\"9.890579531202093e-05\",\"payload.core_data.size.length\":\"500\",\"payload.core_data.size.width\":\"200\",\"payload.core_data.elev\":\"384\",\"payload.core_data.angle\":\"127\",\"payload.core_data.id\":\"11111111\",\"payload.core_data.lat\":\"38.9549740\",\"payload.core_data.msg_count\":\"70\"}";
        String k_v_pairs = converter.convertJson2KeyValuePairs(json_str, to_str_fields,new ArrayList<String>());
=======
        List<String> to_str_values = Arrays.asList("hostBSMId,TrafficControlRequest.reqid,tcmV01.reqid".split(","));
        String json_str = "{\"metadata.unit_name\":\"BlackPacifica\",\"metadata.event_name\":\"UC3\",\"metadata.location\":\"TFHRC\",\"metadata.unit_type\":\"Platform\",\"metadata.unit_id\":\"DOT-508\",\"metadata.testing_type\":\"Integration\",\"payload.core_data.sec_mark\":\"40328\",\"payload.core_data.heading\":\"6160\",\"payload.core_data.brakes.scs\":\"0\",\"payload.core_data.brakes.abs\":\"0\",\"payload.core_data.brakes.aux_brakes\":\"0\",\"payload.core_data.brakes.brake_boost\":\"0\",\"payload.core_data.brakes.traction\":\"0\",\"payload.core_data.accel_set.vert\":\"-127\",\"payload.core_data.accel_set.lat\":\"2\",\"payload.core_data.accel_set.long\":\"-79\",\"payload.core_data.accel_set.yaw\":\"12\",\"payload.core_data.accuracy.orientation\":\"65535\",\"payload.core_data.accuracy.semi_minor\":\"255\",\"payload.core_data.accuracy.semi_major\":\"255\",\"payload.core_data.long\":\"-77.1476267\",\"payload.core_data.speed\":\"282\",\"payload.core_data.transmission\":\"9.890579531202093e-05\",\"payload.core_data.size.length\":\"500\",\"payload.core_data.size.width\":\"200\",\"payload.core_data.elev\":\"384\",\"payload.core_data.angle\":\"127\",\"payload.core_data.id\":\"11111111\",\"payload.core_data.lat\":\"38.9549740\",\"payload.core_data.msg_count\":\"70\"}";
        String k_v_pairs = converter.convertJson2KeyValuePairs(json_str, to_str_values);
>>>>>>> origin/master
        String expected = "metadata.unit_id=\"DOT-508\",payload.core_data.accuracy.semi_major=255,payload.core_data.brakes.abs=0,payload.core_data.transmission=0.0,payload.core_data.brakes.brake_boost=0,payload.core_data.accel_set.long=-79,payload.core_data.accuracy.semi_minor=255,metadata.unit_type=\"Platform\",payload.core_data.brakes.scs=0,payload.core_data.brakes.traction=0,payload.core_data.lat=38.9549740,payload.core_data.heading=6160,payload.core_data.accel_set.yaw=12,payload.core_data.size.length=500,payload.core_data.size.width=200,metadata.testing_type=\"Integration\",payload.core_data.speed=282,payload.core_data.angle=127,metadata.event_name=\"UC3\",payload.core_data.long=-77.1476267,payload.core_data.brakes.aux_brakes=0,payload.core_data.msg_count=70,payload.core_data.accel_set.lat=2,metadata.location=\"TFHRC\",payload.core_data.sec_mark=40328,payload.core_data.id=11111111,metadata.unit_name=\"BlackPacifica\",payload.core_data.accel_set.vert=-127,payload.core_data.elev=384,payload.core_data.accuracy.orientation=65535";
        assertEquals(expected, k_v_pairs);

        String mo_json_str = "{\"unit_name\":\"WestIntersection\",\"payload.metadata.hostStaticId\":\"DOT-45244\",\"payload.metadata.targetStaticId\":\"UNSET\",\"payload.metadata.hostBSMId\":\"1234562\",\"payload.metadata.planId\":\"a95fe925-1c09-43eb-b40e-5abe7611b187\",\"payload.metadata.timestamp\":\"0000001681146252589\",\"payload.trajectory.offsets[0].offsetX\":51,\"payload.trajectory.offsets[0].offsetZ\":-18,\"payload.trajectory.offsets[0].offsetY\":-3,\"payload.trajectory.offsets[1].offsetX\":96,\"payload.trajectory.offsets[1].offsetZ\":-28,\"payload.trajectory.offsets[1].offsetY\":-1,\"payload.trajectory.offsets[2].offsetX\":96,\"payload.trajectory.offsets[2].offsetZ\":-29,\"payload.trajectory.offsets[2].offsetY\":-2,\"payload.trajectory.offsets[3].offsetX\":96,\"payload.trajectory.offsets[3].offsetZ\":-28,\"payload.trajectory.offsets[3].offsetY\":-2,\"payload.trajectory.offsets[4].offsetX\":96,\"payload.trajectory.offsets[4].offsetZ\":-28,\"payload.trajectory.offsets[4].offsetY\":-1,\"payload.trajectory.offsets[5].offsetX\":96,\"payload.trajectory.offsets[5].offsetZ\":-29,\"payload.trajectory.offsets[5].offsetY\":-2,\"payload.trajectory.offsets[6].offsetX\":96,\"payload.trajectory.offsets[6].offsetZ\":-28,\"payload.trajectory.offsets[6].offsetY\":-1,\"payload.trajectory.offsets[7].offsetX\":96,\"payload.trajectory.offsets[7].offsetZ\":-29,\"payload.trajectory.offsets[7].offsetY\":-2,\"payload.trajectory.offsets[8].offsetX\":97,\"payload.trajectory.offsets[8].offsetZ\":-28,\"payload.trajectory.offsets[8].offsetY\":-1,\"payload.trajectory.offsets[9].offsetX\":96,\"payload.trajectory.offsets[9].offsetZ\":-28,\"payload.trajectory.offsets[9].offsetY\":-2,\"payload.trajectory.offsets[10].offsetX\":96,\"payload.trajectory.offsets[10].offsetZ\":-27,\"payload.trajectory.offsets[10].offsetY\":0,\"payload.trajectory.offsets[11].offsetX\":97,\"payload.trajectory.offsets[11].offsetZ\":-27,\"payload.trajectory.offsets[11].offsetY\":-1,\"payload.trajectory.offsets[12].offsetX\":96,\"payload.trajectory.offsets[12].offsetZ\":-26,\"payload.trajectory.offsets[12].offsetY\":1,\"payload.trajectory.offsets[13].offsetX\":97,\"payload.trajectory.offsets[13].offsetZ\":-26,\"payload.trajectory.offsets[13].offsetY\":1,\"payload.trajectory.offsets[14].offsetX\":97,\"payload.trajectory.offsets[14].offsetZ\":-25,\"payload.trajectory.offsets[14].offsetY\":1,\"payload.trajectory.offsets[15].offsetX\":98,\"payload.trajectory.offsets[15].offsetZ\":-24,\"payload.trajectory.offsets[15].offsetY\":2,\"payload.trajectory.offsets[16].offsetX\":97,\"payload.trajectory.offsets[16].offsetZ\":-24,\"payload.trajectory.offsets[16].offsetY\":3,\"payload.trajectory.offsets[17].offsetX\":97,\"payload.trajectory.offsets[17].offsetZ\":-23,\"payload.trajectory.offsets[17].offsetY\":3,\"payload.trajectory.offsets[18].offsetX\":98,\"payload.trajectory.offsets[18].offsetZ\":-22,\"payload.trajectory.offsets[18].offsetY\":3,\"payload.trajectory.offsets[19].offsetX\":98,\"payload.trajectory.offsets[19].offsetZ\":-22,\"payload.trajectory.offsets[19].offsetY\":5,\"payload.trajectory.offsets[20].offsetX\":97,\"payload.trajectory.offsets[20].offsetZ\":-21,\"payload.trajectory.offsets[20].offsetY\":4,\"payload.trajectory.offsets[21].offsetX\":77,\"payload.trajectory.offsets[21].offsetZ\":-16,\"payload.trajectory.offsets[21].offsetY\":4,\"payload.trajectory.offsets[22].offsetX\":100,\"payload.trajectory.offsets[22].offsetZ\":-21,\"payload.trajectory.offsets[22].offsetY\":6,\"payload.trajectory.offsets[23].offsetX\":100,\"payload.trajectory.offsets[23].offsetZ\":-20,\"payload.trajectory.offsets[23].offsetY\":7,\"payload.trajectory.offsets[24].offsetX\":100,\"payload.trajectory.offsets[24].offsetZ\":-19,\"payload.trajectory.offsets[24].offsetY\":6,\"payload.trajectory.offsets[25].offsetX\":100,\"payload.trajectory.offsets[25].offsetZ\":-18,\"payload.trajectory.offsets[25].offsetY\":8,\"payload.trajectory.offsets[26].offsetX\":100,\"payload.trajectory.offsets[26].offsetZ\":-18,\"payload.trajectory.offsets[26].offsetY\":8,\"payload.trajectory.offsets[27].offsetX\":100,\"payload.trajectory.offsets[27].offsetZ\":-17,\"payload.trajectory.offsets[27].offsetY\":9,\"payload.trajectory.offsets[28].offsetX\":100,\"payload.trajectory.offsets[28].offsetZ\":-16,\"payload.trajectory.offsets[28].offsetY\":9,\"payload.trajectory.offsets[29].offsetX\":101,\"payload.trajectory.offsets[29].offsetZ\":-16,\"payload.trajectory.offsets[29].offsetY\":10,\"payload.trajectory.offsets[30].offsetX\":100,\"payload.trajectory.offsets[30].offsetZ\":-15,\"payload.trajectory.offsets[30].offsetY\":10,\"payload.trajectory.offsets[31].offsetX\":100,\"payload.trajectory.offsets[31].offsetZ\":-16,\"payload.trajectory.offsets[31].offsetY\":10,\"payload.trajectory.offsets[32].offsetX\":101,\"payload.trajectory.offsets[32].offsetZ\":-14,\"payload.trajectory.offsets[32].offsetY\":11,\"payload.trajectory.offsets[33].offsetX\":100,\"payload.trajectory.offsets[33].offsetZ\":-15,\"payload.trajectory.offsets[33].offsetY\":11,\"payload.trajectory.offsets[34].offsetX\":100,\"payload.trajectory.offsets[34].offsetZ\":-15,\"payload.trajectory.offsets[34].offsetY\":11,\"payload.trajectory.offsets[35].offsetX\":101,\"payload.trajectory.offsets[35].offsetZ\":-14,\"payload.trajectory.offsets[35].offsetY\":10,\"payload.trajectory.offsets[36].offsetX\":100,\"payload.trajectory.offsets[36].offsetZ\":-14,\"payload.trajectory.offsets[36].offsetY\":11,\"payload.trajectory.offsets[37].offsetX\":100,\"payload.trajectory.offsets[37].offsetZ\":-15,\"payload.trajectory.offsets[37].offsetY\":12,\"payload.trajectory.offsets[38].offsetX\":101,\"payload.trajectory.offsets[38].offsetZ\":-14,\"payload.trajectory.offsets[38].offsetY\":11,\"payload.trajectory.offsets[39].offsetX\":100,\"payload.trajectory.offsets[39].offsetZ\":-14,\"payload.trajectory.offsets[39].offsetY\":11,\"payload.trajectory.offsets[40].offsetX\":100,\"payload.trajectory.offsets[40].offsetZ\":-14,\"payload.trajectory.offsets[40].offsetY\":12,\"payload.trajectory.offsets[41].offsetX\":101,\"payload.trajectory.offsets[41].offsetZ\":-13,\"payload.trajectory.offsets[41].offsetY\":11,\"payload.trajectory.offsets[42].offsetX\":100,\"payload.trajectory.offsets[42].offsetZ\":-14,\"payload.trajectory.offsets[42].offsetY\":12,\"payload.trajectory.offsets[43].offsetX\":101,\"payload.trajectory.offsets[43].offsetZ\":-13,\"payload.trajectory.offsets[43].offsetY\":11,\"payload.trajectory.location.ecefX\":110457775,\"payload.trajectory.location.ecefZ\":398843563,\"payload.trajectory.location.ecefY\":-484207718,\"payload.trajectory.location.timestamp\":\"0000000000000000000\",\"topic_name\":\"v2xhub_mobility_path_in\",\"msg_type\":\"v2xhub_mobility_path_in\",\"event_name\":\"WFD_Verification_2\",\"location\":\"TFHRC\",\"unit_type\":\"infrastructure\",\"unit_id\":\"streets_id\",\"testing_type\":\"Verification\",\"timestamp\":1681146252589000}";
<<<<<<< HEAD
        String mo_k_v_pairs = converter.convertJson2KeyValuePairs(mo_json_str, to_str_fields, new ArrayList<String>());
        expected = "payload.metadata.hostStaticId=\"DOT-45244\",payload.trajectory.offsets[41].offsetZ=-13,payload.trajectory.offsets[41].offsetY=11,payload.trajectory.offsets[41].offsetX=101,payload.trajectory.offsets[32].offsetX=101,payload.trajectory.offsets[32].offsetZ=-14,payload.trajectory.offsets[32].offsetY=11,payload.trajectory.offsets[3].offsetZ=-28,payload.trajectory.offsets[3].offsetY=-2,payload.trajectory.offsets[29].offsetX=101,payload.trajectory.offsets[29].offsetZ=-16,payload.trajectory.offsets[29].offsetY=10,payload.trajectory.offsets[3].offsetX=96,payload.trajectory.offsets[38].offsetX=101,payload.trajectory.offsets[8].offsetY=-1,payload.trajectory.offsets[38].offsetY=11,payload.trajectory.offsets[8].offsetX=97,payload.trajectory.offsets[38].offsetZ=-14,payload.trajectory.offsets[31].offsetZ=-16,payload.trajectory.offsets[37].offsetY=12,payload.trajectory.offsets[8].offsetZ=-28,payload.trajectory.offsets[37].offsetX=100,payload.trajectory.offsets[31].offsetX=100,payload.trajectory.offsets[31].offsetY=10,payload.trajectory.offsets[2].offsetX=96,payload.trajectory.offsets[2].offsetY=-2,payload.trajectory.offsets[13].offsetZ=-26,payload.trajectory.offsets[2].offsetZ=-29,payload.trajectory.offsets[13].offsetY=1,payload.trajectory.offsets[14].offsetX=97,payload.trajectory.offsets[13].offsetX=97,payload.trajectory.offsets[14].offsetZ=-25,payload.trajectory.offsets[14].offsetY=1,payload.trajectory.offsets[19].offsetZ=-22,payload.trajectory.offsets[37].offsetZ=-15,payload.metadata.planId=\"a95fe925-1c09-43eb-b40e-5abe7611b187\",payload.trajectory.offsets[19].offsetX=98,payload.trajectory.offsets[19].offsetY=5,testing_type=\"Verification\",payload.trajectory.offsets[18].offsetX=98,payload.trajectory.offsets[1].offsetZ=-28,payload.trajectory.offsets[7].offsetX=96,payload.trajectory.offsets[1].offsetY=-1,payload.trajectory.offsets[1].offsetX=96,payload.trajectory.offsets[18].offsetZ=-22,payload.trajectory.offsets[18].offsetY=3,payload.trajectory.offsets[27].offsetY=9,payload.trajectory.offsets[27].offsetZ=-17,payload.trajectory.offsets[27].offsetX=100,payload.trajectory.offsets[33].offsetZ=-15,payload.trajectory.offsets[33].offsetY=11,payload.trajectory.offsets[33].offsetX=100,payload.trajectory.offsets[24].offsetZ=-19,payload.trajectory.offsets[24].offsetX=100,payload.trajectory.offsets[24].offsetY=6,payload.trajectory.offsets[30].offsetX=100,unit_id=\"streets_id\",payload.trajectory.offsets[30].offsetZ=-15,payload.trajectory.offsets[30].offsetY=10,timestamp=1681146252589000,payload.trajectory.offsets[22].offsetZ=-21,payload.trajectory.offsets[22].offsetY=6,payload.trajectory.offsets[22].offsetX=100,payload.metadata.timestamp=0000001681146252589,payload.trajectory.offsets[9].offsetY=-2,payload.trajectory.offsets[9].offsetZ=-28,payload.trajectory.offsets[9].offsetX=96,payload.trajectory.offsets[16].offsetX=97,payload.trajectory.offsets[16].offsetY=3,payload.metadata.hostBSMId=1234562,payload.trajectory.offsets[16].offsetZ=-24,payload.trajectory.offsets[11].offsetY=-1,payload.trajectory.offsets[4].offsetZ=-28,payload.trajectory.offsets[11].offsetX=97,payload.trajectory.offsets[4].offsetY=-1,payload.trajectory.offsets[4].offsetX=96,payload.trajectory.offsets[11].offsetZ=-27,payload.trajectory.offsets[35].offsetX=101,payload.trajectory.offsets[35].offsetY=10,payload.trajectory.offsets[35].offsetZ=-14,payload.trajectory.offsets[26].offsetZ=-18,payload.trajectory.offsets[6].offsetZ=-28,payload.trajectory.offsets[0].offsetZ=-18,payload.metadata.targetStaticId=\"UNSET\",payload.trajectory.offsets[6].offsetX=96,payload.trajectory.offsets[26].offsetY=8,payload.trajectory.offsets[6].offsetY=-1,payload.trajectory.offsets[26].offsetX=100,payload.trajectory.location.timestamp=0000000000000000000,payload.trajectory.offsets[0].offsetY=-3,payload.trajectory.offsets[0].offsetX=51,payload.trajectory.offsets[25].offsetZ=-18,payload.trajectory.offsets[25].offsetY=8,unit_name=\"WestIntersection\",payload.trajectory.offsets[20].offsetX=97,payload.trajectory.offsets[20].offsetY=4,payload.trajectory.offsets[20].offsetZ=-21,payload.trajectory.offsets[43].offsetX=101,msg_type=\"v2xhub_mobility_path_in\",event_name=\"WFD_Verification_2\",payload.trajectory.offsets[7].offsetZ=-29,payload.trajectory.offsets[7].offsetY=-2,payload.trajectory.offsets[25].offsetX=100,payload.trajectory.offsets[43].offsetY=11,payload.trajectory.offsets[43].offsetZ=-13,payload.trajectory.offsets[12].offsetY=1,payload.trajectory.offsets[15].offsetX=98,payload.trajectory.offsets[12].offsetZ=-26,payload.trajectory.offsets[15].offsetY=2,payload.trajectory.offsets[12].offsetX=96,payload.trajectory.location.ecefX=110457775,payload.trajectory.location.ecefY=-484207718,payload.trajectory.location.ecefZ=398843563,unit_type=\"infrastructure\",payload.trajectory.offsets[36].offsetX=100,payload.trajectory.offsets[36].offsetZ=-14,payload.trajectory.offsets[36].offsetY=11,payload.trajectory.offsets[42].offsetX=100,payload.trajectory.offsets[42].offsetY=12,payload.trajectory.offsets[42].offsetZ=-14,payload.trajectory.offsets[21].offsetZ=-16,topic_name=\"v2xhub_mobility_path_in\",payload.trajectory.offsets[21].offsetY=4,payload.trajectory.offsets[15].offsetZ=-24,payload.trajectory.offsets[21].offsetX=77,payload.trajectory.offsets[28].offsetZ=-16,payload.trajectory.offsets[28].offsetY=9,payload.trajectory.offsets[28].offsetX=100,payload.trajectory.offsets[5].offsetX=96,payload.trajectory.offsets[5].offsetY=-2,payload.trajectory.offsets[10].offsetZ=-27,payload.trajectory.offsets[5].offsetZ=-29,payload.trajectory.offsets[10].offsetY=0,payload.trajectory.offsets[10].offsetX=96,payload.trajectory.offsets[17].offsetY=3,payload.trajectory.offsets[17].offsetX=97,payload.trajectory.offsets[17].offsetZ=-23,payload.trajectory.offsets[39].offsetZ=-14,payload.trajectory.offsets[23].offsetX=100,payload.trajectory.offsets[23].offsetY=7,payload.trajectory.offsets[39].offsetX=100,payload.trajectory.offsets[23].offsetZ=-20,payload.trajectory.offsets[39].offsetY=11,payload.trajectory.offsets[40].offsetZ=-14,payload.trajectory.offsets[40].offsetY=12,location=\"TFHRC\",payload.trajectory.offsets[40].offsetX=100,payload.trajectory.offsets[34].offsetY=11,payload.trajectory.offsets[34].offsetZ=-15,payload.trajectory.offsets[34].offsetX=100";
        assertEquals(expected, mo_k_v_pairs);


        String tcr_json_str = "{\"unit_name\":\"DevCC\",\"log_timestamp\":1681309089425000,\"payload.TrafficControlRequest.@list\":\"true\",\"payload.TrafficControlRequest.bounds.oldest\":\"28000218\",\"payload.TrafficControlRequest.bounds.offsets[0].deltax\":\"3232\",\"payload.TrafficControlRequest.bounds.offsets[0].deltay\":\"0\",\"payload.TrafficControlRequest.bounds.offsets[1].deltax\":\"3232\",\"payload.TrafficControlRequest.bounds.offsets[1].deltay\":\"1577\",\"payload.TrafficControlRequest.bounds.offsets[2].deltax\":\"0\",\"payload.TrafficControlRequest.bounds.offsets[2].deltay\":\"1577\",\"payload.TrafficControlRequest.bounds.reflat\":\"389543898\",\"payload.TrafficControlRequest.bounds.reflon\":\"-771510185\",\"payload.TrafficControlRequest.scale\":\"-1\",\"payload.TrafficControlRequest.@port\":\"22222\",\"payload.TrafficControlRequest.reqseq\":\"0\",\"payload.TrafficControlRequest.reqid\":\"4947918446524149\",\"topic_name\":\"TCR\",\"msg_type\":\"TCR\",\"event_name\":\"WFD_Verification_2\",\"location\":\"TFHRC\",\"unit_type\":\"infrastructure\",\"unit_id\":\"cloud_id\",\"testing_type\":\"Verification\",\"timestamp\":1681309089575201}";
        String tcr_k_v_pairs = converter.convertJson2KeyValuePairs(tcr_json_str, to_str_fields, new ArrayList<String>());
        expected = "log_timestamp=1681309089425000,payload.TrafficControlRequest.reqseq=0,payload.TrafficControlRequest.bounds.oldest=28000218,payload.TrafficControlRequest.bounds.reflon=-771510185,unit_type=\"infrastructure\",payload.TrafficControlRequest.@list=\"true\",unit_name=\"DevCC\",payload.TrafficControlRequest.scale=-1,payload.TrafficControlRequest.bounds.offsets[2].deltay=1577,payload.TrafficControlRequest.bounds.offsets[2].deltax=0,payload.TrafficControlRequest.@port=22222,payload.TrafficControlRequest.bounds.offsets[1].deltax=3232,payload.TrafficControlRequest.bounds.offsets[1].deltay=1577,payload.TrafficControlRequest.reqid=4947918446524149,payload.TrafficControlRequest.bounds.offsets[0].deltax=3232,topic_name=\"TCR\",payload.TrafficControlRequest.bounds.offsets[0].deltay=0,msg_type=\"TCR\",event_name=\"WFD_Verification_2\",location=\"TFHRC\",payload.TrafficControlRequest.bounds.reflat=389543898,unit_id=\"cloud_id\",testing_type=\"Verification\",timestamp=1681309089575201";
        assertEquals(expected, tcr_k_v_pairs);

        String tcm_json_str = "{\"payload.TrafficControlMessage.tcmV01.msgnum\":\"1\",\"payload.TrafficControlMessage.tcmV01.geometry.datum\":\"WGS84\",\"payload.TrafficControlMessage.tcmV01.geometry.reftime\":\"28004757\",\"payload.TrafficControlMessage.tcmV01.geometry.refwidth\":\"405\",\"payload.TrafficControlMessage.tcmV01.geometry.heading\":\"3312\",\"payload.TrafficControlMessage.tcmV01.geometry.proj\":\"epsg:3785\",\"payload.TrafficControlMessage.tcmV01.geometry.reflat\":\"389549140\",\"payload.TrafficControlMessage.tcmV01.geometry.refelv\":\"0\",\"payload.TrafficControlMessage.tcmV01.geometry.reflon\":\"-771490031\",\"payload.TrafficControlMessage.tcmV01.id\":\"007d1d1c5ea3f134ab2e9d868a033372\",\"payload.TrafficControlMessage.tcmV01.params.schedule.start\":\"28004757\",\"payload.TrafficControlMessage.tcmV01.params.schedule.end\":\"153722867280912\",\"payload.TrafficControlMessage.tcmV01.params.schedule.dow\":\"1111111\",\"payload.TrafficControlMessage.tcmV01.params.regulatory.true\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.bus\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-fewer-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.two-axle-six-tire-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.five-or-fewer-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.five-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.six-or-more-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.motorcycle\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.passenger-car\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.six-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.seven-or-more-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.micromobile\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.light-truck-van\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.three-axle-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-more-axle-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.detail.maxspeed\":\"45\",\"payload.TrafficControlMessage.tcmV01.reqseq\":\"0\",\"payload.TrafficControlMessage.tcmV01.msgtot\":\"1\",\"payload.TrafficControlMessage.tcmV01.updated\":\"0\",\"payload.TrafficControlMessage.tcmV01.reqid\":\"4947918446524142\"}";
        String tcm_k_v_pairs = converter.convertJson2KeyValuePairs(tcm_json_str, to_str_fields, new ArrayList<String>());
        expected = "payload.TrafficControlMessage.tcmV01.id=\"007d1d1c5ea3f134ab2e9d868a033372\",payload.TrafficControlMessage.tcmV01.params.vclasses.seven-or-more-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.reqid=4947918446524142,payload.TrafficControlMessage.tcmV01.geometry.reflat=389549140,payload.TrafficControlMessage.tcmV01.params.vclasses.light-truck-van=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-more-axle-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.geometry.refwidth=405,payload.TrafficControlMessage.tcmV01.params.vclasses.bus=\"None\",payload.TrafficControlMessage.tcmV01.geometry.heading=3312,payload.TrafficControlMessage.tcmV01.params.regulatory.true=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-fewer-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.motorcycle=\"None\",payload.TrafficControlMessage.tcmV01.geometry.reftime=28004757,payload.TrafficControlMessage.tcmV01.params.vclasses.six-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.three-axle-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.passenger-car=\"None\",payload.TrafficControlMessage.tcmV01.geometry.reflon=-771490031,payload.TrafficControlMessage.tcmV01.msgtot=1,payload.TrafficControlMessage.tcmV01.params.detail.maxspeed=45,payload.TrafficControlMessage.tcmV01.params.schedule.start=28004757,payload.TrafficControlMessage.tcmV01.params.schedule.dow=1111111,payload.TrafficControlMessage.tcmV01.geometry.datum=\"WGS84\",payload.TrafficControlMessage.tcmV01.params.vclasses.two-axle-six-tire-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.msgnum=1,payload.TrafficControlMessage.tcmV01.reqseq=0,payload.TrafficControlMessage.tcmV01.params.schedule.end=153722867280912,payload.TrafficControlMessage.tcmV01.params.vclasses.micromobile=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.six-or-more-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.updated=0,payload.TrafficControlMessage.tcmV01.params.vclasses.five-or-fewer-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.five-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.geometry.proj=\"epsg:3785\",payload.TrafficControlMessage.tcmV01.geometry.refelv=0";
=======
        String mo_k_v_pairs = converter.convertJson2KeyValuePairs(mo_json_str, to_str_values);
        expected = "payload.metadata.hostStaticId=\"DOT-45244\",payload.trajectory.offsets[41].offsetZ=-13,payload.trajectory.offsets[41].offsetY=11,payload.trajectory.offsets[41].offsetX=101,payload.trajectory.offsets[32].offsetX=101,payload.trajectory.offsets[32].offsetZ=-14,payload.trajectory.offsets[32].offsetY=11,payload.trajectory.offsets[3].offsetZ=-28,payload.trajectory.offsets[3].offsetY=-2,payload.trajectory.offsets[29].offsetX=101,payload.trajectory.offsets[29].offsetZ=-16,payload.trajectory.offsets[29].offsetY=10,payload.trajectory.offsets[3].offsetX=96,payload.trajectory.offsets[38].offsetX=101,payload.trajectory.offsets[8].offsetY=-1,payload.trajectory.offsets[38].offsetY=11,payload.trajectory.offsets[8].offsetX=97,payload.trajectory.offsets[38].offsetZ=-14,payload.trajectory.offsets[31].offsetZ=-16,payload.trajectory.offsets[37].offsetY=12,payload.trajectory.offsets[8].offsetZ=-28,payload.trajectory.offsets[37].offsetX=100,payload.trajectory.offsets[31].offsetX=100,payload.trajectory.offsets[31].offsetY=10,payload.trajectory.offsets[2].offsetX=96,payload.trajectory.offsets[2].offsetY=-2,payload.trajectory.offsets[13].offsetZ=-26,payload.trajectory.offsets[2].offsetZ=-29,payload.trajectory.offsets[13].offsetY=1,payload.trajectory.offsets[14].offsetX=97,payload.trajectory.offsets[13].offsetX=97,payload.trajectory.offsets[14].offsetZ=-25,payload.trajectory.offsets[14].offsetY=1,payload.trajectory.offsets[19].offsetZ=-22,payload.trajectory.offsets[37].offsetZ=-15,payload.metadata.planId=\"a95fe925-1c09-43eb-b40e-5abe7611b187\",payload.trajectory.offsets[19].offsetX=98,payload.trajectory.offsets[19].offsetY=5,testing_type=\"Verification\",payload.trajectory.offsets[18].offsetX=98,payload.trajectory.offsets[1].offsetZ=-28,payload.trajectory.offsets[7].offsetX=96,payload.trajectory.offsets[1].offsetY=-1,payload.trajectory.offsets[1].offsetX=96,payload.trajectory.offsets[18].offsetZ=-22,payload.trajectory.offsets[18].offsetY=3,payload.trajectory.offsets[27].offsetY=9,payload.trajectory.offsets[27].offsetZ=-17,payload.trajectory.offsets[27].offsetX=100,payload.trajectory.offsets[33].offsetZ=-15,payload.trajectory.offsets[33].offsetY=11,payload.trajectory.offsets[33].offsetX=100,payload.trajectory.offsets[24].offsetZ=-19,payload.trajectory.offsets[24].offsetX=100,payload.trajectory.offsets[24].offsetY=6,payload.trajectory.offsets[30].offsetX=100,unit_id=\"streets_id\",payload.trajectory.offsets[30].offsetZ=-15,payload.trajectory.offsets[30].offsetY=10,timestamp=1681146252589000,payload.trajectory.offsets[22].offsetZ=-21,payload.trajectory.offsets[22].offsetY=6,payload.trajectory.offsets[22].offsetX=100,payload.metadata.timestamp=0000001681146252589,payload.trajectory.offsets[9].offsetY=-2,payload.trajectory.offsets[9].offsetZ=-28,payload.trajectory.offsets[9].offsetX=96,payload.trajectory.offsets[16].offsetX=97,payload.trajectory.offsets[16].offsetY=3,payload.metadata.hostBSMId=\"1234562\",payload.trajectory.offsets[16].offsetZ=-24,payload.trajectory.offsets[11].offsetY=-1,payload.trajectory.offsets[4].offsetZ=-28,payload.trajectory.offsets[11].offsetX=97,payload.trajectory.offsets[4].offsetY=-1,payload.trajectory.offsets[4].offsetX=96,payload.trajectory.offsets[11].offsetZ=-27,payload.trajectory.offsets[35].offsetX=101,payload.trajectory.offsets[35].offsetY=10,payload.trajectory.offsets[35].offsetZ=-14,payload.trajectory.offsets[26].offsetZ=-18,payload.trajectory.offsets[6].offsetZ=-28,payload.trajectory.offsets[0].offsetZ=-18,payload.metadata.targetStaticId=\"UNSET\",payload.trajectory.offsets[6].offsetX=96,payload.trajectory.offsets[26].offsetY=8,payload.trajectory.offsets[6].offsetY=-1,payload.trajectory.offsets[26].offsetX=100,payload.trajectory.location.timestamp=0000000000000000000,payload.trajectory.offsets[0].offsetY=-3,payload.trajectory.offsets[0].offsetX=51,payload.trajectory.offsets[25].offsetZ=-18,payload.trajectory.offsets[25].offsetY=8,unit_name=\"WestIntersection\",payload.trajectory.offsets[20].offsetX=97,payload.trajectory.offsets[20].offsetY=4,payload.trajectory.offsets[20].offsetZ=-21,payload.trajectory.offsets[43].offsetX=101,msg_type=\"v2xhub_mobility_path_in\",event_name=\"WFD_Verification_2\",payload.trajectory.offsets[7].offsetZ=-29,payload.trajectory.offsets[7].offsetY=-2,payload.trajectory.offsets[25].offsetX=100,payload.trajectory.offsets[43].offsetY=11,payload.trajectory.offsets[43].offsetZ=-13,payload.trajectory.offsets[12].offsetY=1,payload.trajectory.offsets[15].offsetX=98,payload.trajectory.offsets[12].offsetZ=-26,payload.trajectory.offsets[15].offsetY=2,payload.trajectory.offsets[12].offsetX=96,payload.trajectory.location.ecefX=110457775,payload.trajectory.location.ecefY=-484207718,payload.trajectory.location.ecefZ=398843563,unit_type=\"infrastructure\",payload.trajectory.offsets[36].offsetX=100,payload.trajectory.offsets[36].offsetZ=-14,payload.trajectory.offsets[36].offsetY=11,payload.trajectory.offsets[42].offsetX=100,payload.trajectory.offsets[42].offsetY=12,payload.trajectory.offsets[42].offsetZ=-14,payload.trajectory.offsets[21].offsetZ=-16,topic_name=\"v2xhub_mobility_path_in\",payload.trajectory.offsets[21].offsetY=4,payload.trajectory.offsets[15].offsetZ=-24,payload.trajectory.offsets[21].offsetX=77,payload.trajectory.offsets[28].offsetZ=-16,payload.trajectory.offsets[28].offsetY=9,payload.trajectory.offsets[28].offsetX=100,payload.trajectory.offsets[5].offsetX=96,payload.trajectory.offsets[5].offsetY=-2,payload.trajectory.offsets[10].offsetZ=-27,payload.trajectory.offsets[5].offsetZ=-29,payload.trajectory.offsets[10].offsetY=0,payload.trajectory.offsets[10].offsetX=96,payload.trajectory.offsets[17].offsetY=3,payload.trajectory.offsets[17].offsetX=97,payload.trajectory.offsets[17].offsetZ=-23,payload.trajectory.offsets[39].offsetZ=-14,payload.trajectory.offsets[23].offsetX=100,payload.trajectory.offsets[23].offsetY=7,payload.trajectory.offsets[39].offsetX=100,payload.trajectory.offsets[23].offsetZ=-20,payload.trajectory.offsets[39].offsetY=11,payload.trajectory.offsets[40].offsetZ=-14,payload.trajectory.offsets[40].offsetY=12,location=\"TFHRC\",payload.trajectory.offsets[40].offsetX=100,payload.trajectory.offsets[34].offsetY=11,payload.trajectory.offsets[34].offsetZ=-15,payload.trajectory.offsets[34].offsetX=100";
        assertEquals(expected, mo_k_v_pairs);

        String tcr_json_str = "{\"unit_name\":\"DevCC\",\"log_timestamp\":1681309089425000,\"payload.TrafficControlRequest.@list\":\"true\",\"payload.TrafficControlRequest.bounds.oldest\":\"28000218\",\"payload.TrafficControlRequest.bounds.offsets[0].deltax\":\"3232\",\"payload.TrafficControlRequest.bounds.offsets[0].deltay\":\"0\",\"payload.TrafficControlRequest.bounds.offsets[1].deltax\":\"3232\",\"payload.TrafficControlRequest.bounds.offsets[1].deltay\":\"1577\",\"payload.TrafficControlRequest.bounds.offsets[2].deltax\":\"0\",\"payload.TrafficControlRequest.bounds.offsets[2].deltay\":\"1577\",\"payload.TrafficControlRequest.bounds.reflat\":\"389543898\",\"payload.TrafficControlRequest.bounds.reflon\":\"-771510185\",\"payload.TrafficControlRequest.scale\":\"-1\",\"payload.TrafficControlRequest.@port\":\"22222\",\"payload.TrafficControlRequest.reqseq\":\"0\",\"payload.TrafficControlRequest.reqid\":\"4947918446524149\",\"topic_name\":\"TCR\",\"msg_type\":\"TCR\",\"event_name\":\"WFD_Verification_2\",\"location\":\"TFHRC\",\"unit_type\":\"infrastructure\",\"unit_id\":\"cloud_id\",\"testing_type\":\"Verification\",\"timestamp\":1681309089575201}";
        String tcr_k_v_pairs = converter.convertJson2KeyValuePairs(tcr_json_str, to_str_values);
        expected = "log_timestamp=1681309089425000,payload.TrafficControlRequest.reqseq=0,payload.TrafficControlRequest.bounds.oldest=28000218,payload.TrafficControlRequest.bounds.reflon=-771510185,unit_type=\"infrastructure\",payload.TrafficControlRequest.@list=\"true\",unit_name=\"DevCC\",payload.TrafficControlRequest.scale=-1,payload.TrafficControlRequest.bounds.offsets[2].deltay=1577,payload.TrafficControlRequest.bounds.offsets[2].deltax=0,payload.TrafficControlRequest.@port=22222,payload.TrafficControlRequest.bounds.offsets[1].deltax=3232,payload.TrafficControlRequest.bounds.offsets[1].deltay=1577,payload.TrafficControlRequest.reqid=\"4947918446524149\",payload.TrafficControlRequest.bounds.offsets[0].deltax=3232,topic_name=\"TCR\",payload.TrafficControlRequest.bounds.offsets[0].deltay=0,msg_type=\"TCR\",event_name=\"WFD_Verification_2\",location=\"TFHRC\",payload.TrafficControlRequest.bounds.reflat=389543898,unit_id=\"cloud_id\",testing_type=\"Verification\",timestamp=1681309089575201";
        assertEquals(expected, tcr_k_v_pairs);

        String tcm_json_str = "{\"payload.TrafficControlMessage.tcmV01.msgnum\":\"1\",\"payload.TrafficControlMessage.tcmV01.geometry.datum\":\"WGS84\",\"payload.TrafficControlMessage.tcmV01.geometry.reftime\":\"28004757\",\"payload.TrafficControlMessage.tcmV01.geometry.refwidth\":\"405\",\"payload.TrafficControlMessage.tcmV01.geometry.heading\":\"3312\",\"payload.TrafficControlMessage.tcmV01.geometry.proj\":\"epsg:3785\",\"payload.TrafficControlMessage.tcmV01.geometry.reflat\":\"389549140\",\"payload.TrafficControlMessage.tcmV01.geometry.refelv\":\"0\",\"payload.TrafficControlMessage.tcmV01.geometry.reflon\":\"-771490031\",\"payload.TrafficControlMessage.tcmV01.id\":\"007d1d1c5ea3f134ab2e9d868a033372\",\"payload.TrafficControlMessage.tcmV01.params.schedule.start\":\"28004757\",\"payload.TrafficControlMessage.tcmV01.params.schedule.end\":\"153722867280912\",\"payload.TrafficControlMessage.tcmV01.params.schedule.dow\":\"1111111\",\"payload.TrafficControlMessage.tcmV01.params.regulatory.true\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.bus\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-fewer-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.two-axle-six-tire-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.five-or-fewer-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.five-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.six-or-more-axle-single-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.motorcycle\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.passenger-car\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.six-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.seven-or-more-axle-multi-trailer-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.micromobile\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.light-truck-van\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.three-axle-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-more-axle-single-unit-truck\":\"None\",\"payload.TrafficControlMessage.tcmV01.params.detail.maxspeed\":\"45\",\"payload.TrafficControlMessage.tcmV01.reqseq\":\"0\",\"payload.TrafficControlMessage.tcmV01.msgtot\":\"1\",\"payload.TrafficControlMessage.tcmV01.updated\":\"0\",\"payload.TrafficControlMessage.tcmV01.reqid\":\"4947918446524142\"}";
        String tcm_k_v_pairs = converter.convertJson2KeyValuePairs(tcm_json_str, to_str_values);
        expected = "payload.TrafficControlMessage.tcmV01.id=\"007d1d1c5ea3f134ab2e9d868a033372\",payload.TrafficControlMessage.tcmV01.params.vclasses.seven-or-more-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.reqid=\"4947918446524142\",payload.TrafficControlMessage.tcmV01.geometry.reflat=389549140,payload.TrafficControlMessage.tcmV01.params.vclasses.light-truck-van=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-more-axle-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.geometry.refwidth=405,payload.TrafficControlMessage.tcmV01.params.vclasses.bus=\"None\",payload.TrafficControlMessage.tcmV01.geometry.heading=3312,payload.TrafficControlMessage.tcmV01.params.regulatory.true=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.four-or-fewer-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.motorcycle=\"None\",payload.TrafficControlMessage.tcmV01.geometry.reftime=28004757,payload.TrafficControlMessage.tcmV01.params.vclasses.six-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.three-axle-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.passenger-car=\"None\",payload.TrafficControlMessage.tcmV01.geometry.reflon=-771490031,payload.TrafficControlMessage.tcmV01.msgtot=1,payload.TrafficControlMessage.tcmV01.params.detail.maxspeed=45,payload.TrafficControlMessage.tcmV01.params.schedule.start=28004757,payload.TrafficControlMessage.tcmV01.params.schedule.dow=1111111,payload.TrafficControlMessage.tcmV01.geometry.datum=\"WGS84\",payload.TrafficControlMessage.tcmV01.params.vclasses.two-axle-six-tire-single-unit-truck=\"None\",payload.TrafficControlMessage.tcmV01.msgnum=1,payload.TrafficControlMessage.tcmV01.reqseq=0,payload.TrafficControlMessage.tcmV01.params.schedule.end=153722867280912,payload.TrafficControlMessage.tcmV01.params.vclasses.micromobile=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.six-or-more-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.updated=0,payload.TrafficControlMessage.tcmV01.params.vclasses.five-or-fewer-axle-multi-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.params.vclasses.five-axle-single-trailer-truck=\"None\",payload.TrafficControlMessage.tcmV01.geometry.proj=\"epsg:3785\",payload.TrafficControlMessage.tcmV01.geometry.refelv=0";
>>>>>>> origin/master
        assertEquals(expected, tcm_k_v_pairs);

        //Message that has NaN value
        String nan_json_str = "{\"metadata.unit_name\":\"BlackPacifica\",\"metadata.event_name\":\"UC3\",\"metadata.location\":\"TFHRC\",\"metadata.unit_type\":\"Platform\",\"metadata.unit_id\":\"DOT-508\",\"metadata.testing_type\":\"Integration\",\"payload.core_data.sec_mark\":\"40328\",\"payload.core_data.heading\":\"6160\",\"payload.core_data.brakes.scs\":\"0\",\"payload.core_data.brakes.abs\":\"NaN\",\"payload.core_data.brakes.aux_brakes\":\"0\",\"payload.core_data.brakes.brake_boost\":\"0\",\"payload.core_data.brakes.traction\":\"0\",\"payload.core_data.accel_set.vert\":\"-127\",\"payload.core_data.accel_set.lat\":\"2\",\"payload.core_data.accel_set.long\":\"-79\",\"payload.core_data.accel_set.yaw\":\"12\",\"payload.core_data.accuracy.orientation\":\"65535\",\"payload.core_data.accuracy.semi_minor\":\"255\",\"payload.core_data.accuracy.semi_major\":\"255\",\"payload.core_data.long\":\"-77.1476267\",\"payload.core_data.speed\":\"282\",\"payload.core_data.transmission\":\"9.890579531202093e-05\",\"payload.core_data.size.length\":\"500\",\"payload.core_data.size.width\":\"200\",\"payload.core_data.elev\":\"384\",\"payload.core_data.angle\":\"127\",\"payload.core_data.id\":\"11111111\",\"payload.core_data.lat\":\"38.9549740\",\"payload.core_data.msg_count\":\"70\"}";
<<<<<<< HEAD
        List<String> ignore_fields = Arrays.asList("metadata.unit_id".split(","));
        String nan_k_v_pairs = converter.convertJson2KeyValuePairs(nan_json_str, to_str_fields, ignore_fields);
        expected = "payload.core_data.accuracy.semi_major=255,payload.core_data.transmission=0.0,payload.core_data.brakes.brake_boost=0,payload.core_data.accel_set.long=-79,payload.core_data.accuracy.semi_minor=255,metadata.unit_type=\"Platform\",payload.core_data.brakes.scs=0,payload.core_data.brakes.traction=0,payload.core_data.lat=38.9549740,payload.core_data.heading=6160,payload.core_data.accel_set.yaw=12,payload.core_data.size.length=500,payload.core_data.size.width=200,metadata.testing_type=\"Integration\",payload.core_data.speed=282,payload.core_data.angle=127,metadata.event_name=\"UC3\",payload.core_data.long=-77.1476267,payload.core_data.brakes.aux_brakes=0,payload.core_data.msg_count=70,payload.core_data.accel_set.lat=2,metadata.location=\"TFHRC\",payload.core_data.sec_mark=40328,payload.core_data.id=11111111,metadata.unit_name=\"BlackPacifica\",payload.core_data.accel_set.vert=-127,payload.core_data.elev=384,payload.core_data.accuracy.orientation=65535";
        assertEquals(expected, nan_k_v_pairs);

        String ignore_field_str = "{\"metadata.unit_name\":\"BlackPacifica\",\"metadata.event_name\":\"UC3\"}";
        ignore_fields = Arrays.asList("metadata.unit_name".split(","));
        String ignore_fields_k_v_pairs = converter.convertJson2KeyValuePairs(ignore_field_str, to_str_fields, ignore_fields);
        expected = "metadata.event_name=\"UC3\"";
        assertEquals(expected, ignore_fields_k_v_pairs);

        expected = "";
        ignore_fields = Arrays.asList("metadata.unit_name,metadata.event_name".split(","));
        ignore_fields_k_v_pairs = converter.convertJson2KeyValuePairs(ignore_field_str, to_str_fields, ignore_fields);
        assertEquals(expected, ignore_fields_k_v_pairs);
=======
        String nan_k_v_pairs = converter.convertJson2KeyValuePairs(nan_json_str, to_str_values);
        expected = "metadata.unit_id=\"DOT-508\",payload.core_data.accuracy.semi_major=255,payload.core_data.brakes.abs=NaN,payload.core_data.transmission=0.0,payload.core_data.brakes.brake_boost=0,payload.core_data.accel_set.long=-79,payload.core_data.accuracy.semi_minor=255,metadata.unit_type=\"Platform\",payload.core_data.brakes.scs=0,payload.core_data.brakes.traction=0,payload.core_data.lat=38.9549740,payload.core_data.heading=6160,payload.core_data.accel_set.yaw=12,payload.core_data.size.length=500,payload.core_data.size.width=200,metadata.testing_type=\"Integration\",payload.core_data.speed=282,payload.core_data.angle=127,metadata.event_name=\"UC3\",payload.core_data.long=-77.1476267,payload.core_data.brakes.aux_brakes=0,payload.core_data.msg_count=70,payload.core_data.accel_set.lat=2,metadata.location=\"TFHRC\",payload.core_data.sec_mark=40328,payload.core_data.id=11111111,metadata.unit_name=\"BlackPacifica\",payload.core_data.accel_set.vert=-127,payload.core_data.elev=384,payload.core_data.accuracy.orientation=65535";
        assertEquals(expected, nan_k_v_pairs);
>>>>>>> origin/master
    }
}
